resource "aws_codeartifact_domain" "codeartifact_domain" {
  domain         = var.name
  encryption_key = aws_kms_key.codeartifact_key.arn

  tags = merge(
    var.tags,
    var.domain_tags
  )
}

resource "aws_codeartifact_repository" "codeartifact_repository" {
  repository = var.name
  domain     = aws_codeartifact_domain.codeartifact_domain.domain

  tags = merge(
    var.tags,
    var.repository_tags
  )
}

---
variable "name" {
  description = "The name of the CodeArtifact domain or repository"
}

variable "tags" {
  description = "A map of tags to assign to the CodeArtifact domain or repository"
  type        = map(string)
  default     = {}
}

variable "domain_tags" {
  description = "A map of tags to assign to the CodeArtifact domain"
  type        = map(string)
  default     = {}
}

variable "repository_tags" {
  description = "A map of tags to assign to the CodeArtifact repository"
  type        = map(string)
  default     = {}
}
---
module "codeartifact" {
  source            = "./path/to/codeartifact-module"
  name              = "my-codeartifact-repository"
  tags              = {
    Environment = "Development"
    Project     = "MyProject"
    Owner       = "John Doe"
    CostCenter  = "12345"
    # Additional tags as needed
  }
  domain_tags       = {
    Environment = "Development"
    Project     = "MyProject"
    Owner       = "John Doe"
    # Additional tags as needed
  }
  repository_tags   = {
    Environment = "Development"
    Project     = "MyProject"
    Owner       = "John Doe"
    CostCenter  = "12345"
    # Additional tags as needed
  }
}
